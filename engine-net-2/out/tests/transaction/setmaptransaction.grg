using setmaptransaction;

rule transform1 {
	a:N;
	if{ "foo" in a.setVal; }
	if{ "foo" in a.mapVal; }
	
	modify {
		eval {
			a.setVal = a.setVal \ set<string>{ "foo" };
			a.setVal = a.setVal | set<string>{ "bar" };
			a.mapVal = a.mapVal \ map<string,string>{ "foo"->"" };
			a.mapVal = a.mapVal | map<string,string>{ "bar"->"foo" };
		}
	}
}

rule transform2 {
	a:N;
	if{ "foo" in a.setVal; }
	if{ "foo" in a.mapVal; }
	
	modify {
		eval {
			a.setVal = a.setVal2;
			a.mapVal = a.mapVal2;
		}
	}
}

test fail {
	a:N;
	if{ "foo" in a.setVal; }
}
